# Saltware IVR 시스템 구현 계획

## 구현 개요

모듈화된 Contact Flow와 Lambda 기반 비즈니스 로직을 단계적으로 구현하여 실용적인 IVR 시스템을 구축합니다.

## 구현 작업 목록

- [x] 1. 데이터 저장소 및 기본 인프라 구축
  - DynamoDB 테이블 생성 (고객 정보, 통화 로그, 엔지니어 정보)
  - IAM 역할 및 정책 설정
  - CloudWatch 로그 그룹 생성
  - _요구사항: 1.1, 1.2, 1.3_

- [x] 1.1 고객 정보 DynamoDB 테이블 생성
  - Customer 테이블 스키마 정의 및 생성
  - GSI 설정 (company_name, aws_account_id 기반 조회)
  - 테스트 데이터 삽입
  - _요구사항: 1.1_

- [x] 1.2 통화 로그 DynamoDB 테이블 생성
  - CallLog 테이블 스키마 정의 및 생성
  - TTL 설정 (로그 보존 기간 관리)
  - 인덱스 최적화
  - _요구사항: 1.2_

- [x] 1.3 엔지니어 정보 DynamoDB 테이블 생성
  - Engineer 테이블 스키마 정의 및 생성
  - 파트별, 가용성별 조회 인덱스
  - COC 가이드 기반 초기 데이터 입력
  - _요구사항: 1.3_

- [x] 2. 핵심 Lambda 함수 구현
  - 고객 조회 함수 개발
  - 업무시간 확인 함수 개발
  - 통화 로깅 함수 개발
  - 단위 테스트 작성
  - _요구사항: 2.1, 2.2, 2.3_

- [x] 2.1 고객 조회 Lambda 함수 구현
  - AWS Account ID와 고객사명으로 고객 정보 조회
  - MSP vs 일반 고객 분류 로직
  - 담당 엔지니어 정보 반환
  - 오류 처리 및 로깅
  - _요구사항: 2.1_

- [x] 2.2 업무시간 확인 Lambda 함수 구현
  - 한국 시간 기준 업무시간 확인 (평일 09:00-18:00)
  - 공휴일 처리 로직
  - 시간대 변환 처리
  - 캐싱을 통한 성능 최적화
  - _요구사항: 2.2_

- [x] 2.3 통화 로깅 Lambda 함수 구현
  - 통화 시작/종료 시점 로깅
  - 고객 정보 및 처리 결과 기록
  - CloudWatch 메트릭 전송
  - 개인정보 보호 처리
  - _요구사항: 2.3_

- [-] 3. Main Entry Contact Flow 구현
  - 환영 메시지 및 초기 라우팅 로직
  - 업무시간 확인 연동
  - 기본 오류 처리
  - 테스트 및 검증
  - _요구사항: 3.1, 3.2_

- [ ] 3.1 기본 환영 메시지 및 시간 확인 Flow
  - "안녕하세요! Saltware 클라우드 기술 지원센터입니다" 메시지
  - Lambda 함수 호출하여 업무시간 확인
  - 업무시간/업무시간 외 분기 처리
  - 기본 오류 처리 (Lambda 호출 실패 등)
  - _요구사항: 3.1_

- [ ] 3.2 세부 Flow로의 라우팅 구현
  - 업무시간 중: Customer Authentication Flow로 전환
  - 업무시간 외: After Hours Flow로 전환
  - Flow 간 컨텍스트 데이터 전달
  - 전환 실패 시 폴백 처리
  - _요구사항: 3.2_

- [ ] 4. Customer Authentication Flow 구현
  - 음성 인식을 통한 고객 정보 수집
  - AWS Account ID DTMF 입력 처리
  - 고객 조회 Lambda 연동
  - 인증 실패 시 처리 로직
  - _요구사항: 4.1, 4.2, 4.3_

- [ ] 4.1 고객 정보 수집 구현
  - 음성 인식으로 고객사명, 담당자명 수집
  - "말씀이 끝나시면 #을 눌러주세요" 안내
  - 음성 인식 실패 시 재시도 로직 (최대 3회)
  - DTMF 입력으로 폴백 옵션 제공
  - _요구사항: 4.1_

- [ ] 4.2 AWS Account ID 입력 처리
  - "AWS Account ID 마지막 4자리를 입력해주세요" 안내
  - DTMF 입력 검증 (4자리 숫자)
  - 입력 오류 시 재입력 요청
  - 확인 불가 시 상담원 연결 옵션
  - _요구사항: 4.2_

- [ ] 4.3 고객 조회 및 분류 처리
  - 수집된 정보로 고객 조회 Lambda 호출
  - 조회 결과에 따른 고객 분류 (MSP/일반/미등록)
  - MSP 고객: MSP Customer Flow로 전환
  - 일반 고객: General Customer Flow로 전환
  - 미등록 고객: 신규 고객 처리 로직
  - _요구사항: 4.3_

- [ ] 5. MSP Customer Flow 구현
  - MSP 고객 전용 메뉴 및 처리
  - 긴급 장애 vs 일반 문의 분류
  - TS 담당자 큐 연결
  - 15분 내 콜백 약속 안내
  - _요구사항: 5.1, 5.2_

- [ ] 5.1 MSP 고객 메뉴 및 긴급도 분류
  - "1번: 긴급 장애 신고, 2번: 일반 기술 문의" 안내
  - 긴급 장애 선택 시 Emergency Flow로 전환
  - 일반 문의 선택 시 일반 MSP 처리
  - 잘못된 입력 시 재안내
  - _요구사항: 5.1_

- [ ] 5.2 MSP 일반 문의 처리 및 담당자 연결
  - "담당 엔지니어가 15분 내에 연락드리겠습니다" 안내
  - MSP General Queue로 라우팅
  - 통화 로그 기록 (고객 정보, 문의 유형)
  - 큐 대기 중 안내 메시지 재생
  - _요구사항: 5.2_

- [ ] 6. General Customer Flow 구현
  - 일반 고객 안내 메시지
  - 이메일 문의 우선 권장
  - 긴급한 경우 담당자 연결 옵션
  - General Queue 라우팅
  - _요구사항: 6.1, 6.2_

- [ ] 6.1 일반 고객 이메일 문의 안내
  - "support@saltware.co.kr로 이메일 문의를 권장합니다" 안내
  - "1번: 이메일 주소 안내, 2번: 긴급한 경우 담당자 연결" 메뉴
  - 이메일 주소 상세 안내 및 반복
  - 이메일 문의 시 자동 티켓 생성 안내
  - _요구사항: 6.1_

- [ ] 6.2 일반 고객 담당자 연결 처리
  - "담당자 확인 후 전화드리겠습니다" 안내
  - General Customer Queue로 라우팅
  - 가용한 General 담당자 확인
  - 대기시간 안내 및 콜백 옵션 제공
  - _요구사항: 6.2_

- [ ] 7. After Hours Flow 구현
  - 업무시간 외 안내 메시지
  - 이메일 문의 안내
  - 긴급 상황 처리 옵션
  - 영업담당자 연락처 안내
  - _요구사항: 7.1, 7.2_

- [ ] 7.1 업무시간 외 기본 안내
  - "현재 업무시간 외입니다. 업무시간은 평일 09:00~18:00입니다" 안내
  - "1번: 이메일 문의, 2번: 긴급 상황, 3번: 영업담당자 연락처" 메뉴
  - 각 옵션별 상세 안내 제공
  - 메뉴 반복 재생 옵션
  - _요구사항: 7.1_

- [ ] 7.2 업무시간 외 긴급 상황 처리
  - 긴급 상황 확인 및 MSP 고객 여부 재확인
  - MSP 고객: 긴급 연락망 안내
  - 일반 고객: 영업담당자 연락 안내
  - 콜백 요청 정보 수집 및 기록
  - _요구사항: 7.2_

- [ ] 8. Emergency Flow 구현
  - 긴급 상황 우선 처리
  - MSP Emergency Queue 연결
  - 즉시 연결 안내
  - 에스컬레이션 로직
  - _요구사항: 8.1, 8.2_

- [ ] 8.1 긴급 상황 접수 및 우선 처리
  - "긴급 장애를 최우선으로 처리하겠습니다" 안내
  - 고객 정보 및 장애 상황 간단 수집
  - MSP Emergency Queue로 즉시 라우팅
  - 통화 로그에 긴급 플래그 설정
  - _요구사항: 8.1_

- [ ] 8.2 에스컬레이션 및 담당자 연결
  - 1차: TS 정담당자 연결 시도
  - 2차: TS 부담당자 연결 시도
  - 3차: 파트 내 다른 구성원 연결
  - 최종: General 담당자 + 관리자 알림
  - 각 단계별 대기시간 최소화
  - _요구사항: 8.2_

- [ ] 9. 큐 시스템 및 라우팅 구현
  - 계층화된 큐 생성 및 설정
  - 담당자 배정 로직
  - 대기시간 모니터링
  - 자동 에스컬레이션
  - _요구사항: 9.1, 9.2_

- [ ] 9.1 계층화된 큐 시스템 구성
  - MSP Emergency Queue (최우선, SLA 15분)
  - MSP General Queue (높음, SLA 30분)
  - General Customer Queue (보통, SLA 1시간)
  - After Hours Queue (낮음, 다음 업무일)
  - 각 큐별 라우팅 프로필 및 우선순위 설정
  - _요구사항: 9.1_

- [ ] 9.2 담당자 자동 배정 시스템
  - 엔지니어 가용성 실시간 확인
  - 업무 부하 기반 순환 배정
  - 전문 분야 매칭 (가능한 경우)
  - 배정 실패 시 에스컬레이션
  - 배정 결과 로깅 및 알림
  - _요구사항: 9.2_

- [ ] 10. 모니터링 및 알림 시스템 구현
  - CloudWatch 대시보드 구성
  - 실시간 알림 설정
  - 성능 지표 수집
  - 장애 감지 및 복구
  - _요구사항: 10.1, 10.2_

- [ ] 10.1 실시간 모니터링 대시보드
  - 현재 통화량 및 큐 상태 표시
  - 담당자별 업무 부하 현황
  - 응답 시간 및 SLA 준수율
  - 시스템 성능 지표 (Lambda 실행시간, DB 응답시간)
  - _요구사항: 10.1_

- [ ] 10.2 알림 및 에스컬레이션 시스템
  - SLA 초과 시 자동 알림 (Slack, 이메일)
  - 시스템 장애 감지 및 알림
  - 담당자 부재 시 에스컬레이션
  - 일일/주간/월간 보고서 자동 생성
  - _요구사항: 10.2_

- [ ] 11. 테스트 및 검증
  - 단위 테스트 실행
  - 통합 테스트 수행
  - 시나리오 기반 테스트
  - 성능 테스트 및 최적화
  - _요구사항: 11.1, 11.2_

- [ ] 11.1 기능 테스트 및 시나리오 검증
  - 각 Flow별 정상 동작 확인
  - 오류 상황 처리 테스트
  - MSP/일반 고객 시나리오 테스트
  - 업무시간/업무시간 외 시나리오 테스트
  - _요구사항: 11.1_

- [ ] 11.2 성능 테스트 및 최적화
  - 동시 통화 처리 능력 테스트
  - Lambda 함수 성능 최적화
  - DynamoDB 쿼리 최적화
  - 응답 시간 개선
  - _요구사항: 11.2_

- [ ] 12. 배포 및 운영 준비
  - 프로덕션 환경 배포
  - 운영 가이드 작성
  - 담당자 교육
  - 점진적 롤아웃
  - _요구사항: 12.1, 12.2_

- [ ] 12.1 프로덕션 배포 및 설정
  - 프로덕션 환경 인프라 구성
  - 보안 설정 및 권한 관리
  - 백업 및 복구 절차 수립
  - 모니터링 및 알림 설정 완료
  - _요구사항: 12.1_

- [ ] 12.2 운영 가이드 및 교육
  - COC 담당자용 운영 가이드 작성
  - 시스템 관리자용 기술 문서 작성
  - 담당자 교육 및 시뮬레이션
  - 장애 대응 절차 수립
  - _요구사항: 12.2_